import{P as n,j as e,u as q,r as i,f as T,a as N,L as v,M as w,O as E}from"./index-BgbQnYg9.js";import{I as M}from"./index-DwU5SCqG.js";import{M as Q}from"./More-hMfBIRX9.js";const k="_form_1m1zq_1",L="_label_1m1zq_13",x={form:k,label:L},$="_input_svg1p_1",z={input:$},y=({type:a,id:o,placeholder:l,children:s})=>e.jsx("input",{className:z.input,type:a,id:o,placeholder:l,children:s});y.propTypes={type:n.string,id:n.string,placeholder:n.string,children:n.node};const A="_btn_fql60_1",C={btn:A},j=({type:a,children:o})=>e.jsx("button",{className:C.btn,type:a,children:o});j.propTypes={type:n.string,children:n.node};const S=({query:a,onSubmit:o})=>{const l=s=>{s.preventDefault();const c=s.target.searchInput.value;if(c.trim()===""){alert("Please enter what you are looking for!");return}const p=c.split(" ").join("+");o(p),s.currentTarget.reset()};return e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:l,className:x.form,children:[e.jsx("span",{className:x.label,children:"Search for movies:"}),e.jsx(y,{type:"text",id:"searchInput",name:"searchInput",value:a,placeholder:"enter part of title"}),e.jsx(j,{type:"submit",children:e.jsx(M,{})})]})})};S.propTypes={query:n.string,onSubmit:n.func};const t={query:"",movies:[],page:1,error:"",more:!1},D=()=>{const[a,o]=q(),[l,s]=i.useState(t.movies),[c,p]=i.useState(t.page),[b,h]=i.useState(t.more),[f,d]=i.useState(t.error),u=a.get("query")??"",_=()=>{s(t.movies),p(t.page),h(t.more),d(t.error)},I=r=>{o(r!==""?{query:r}:{}),_()};i.useEffect(()=>{T(u,c).then(({results:r,total_pages:g})=>{if(r.length===0){h(!1),d(`Sorry, there are no movies matching '${u}'. Please try again.`);return}s(m=>m.length>0&&m[m.length-1].id===r[r.length-1].id?[...m]:[...m,...r]),h(g>c)}).catch(r=>d(r.message))},[u,c]);const P=()=>{p(r=>r+1)};return e.jsxs("main",{children:[e.jsx(N,{children:e.jsx(S,{value:u,onSubmit:I})}),e.jsxs(i.Suspense,{fallback:e.jsx(v,{}),children:[f&&e.jsx("p",{children:f.message}),u&&e.jsx(w,{movies:l}),b&&e.jsx(Q,{onClick:P}),e.jsx(E,{})]})]})};export{D as MoviesLayout};
